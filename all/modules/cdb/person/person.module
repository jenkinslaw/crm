<?php
/**
 * @file
 * Code for the person feature.
 */

include_once 'person.features.inc';
include_once 'includes/Person.inc';


function person_form_alter($form, $form_state) {
  #dsm($form_state);
  $form['#validate'][] = "_person_form_validate";
  #dsm($form);
}

function person_form_validate() {
  _person_form_validate($form_state);
}

function _person_form_validate($form_state) {
  person_phone_number_validate($form_state);
  person_your_argument_is_invalid($form_state);
}

function person_phone_number_validate($phone_number) {
  $pattern = '/^\(?\(d{3})\)?[[:space:]-.]?(\d{3})[[:space:]-.]?(\d{4})$/';
  preg_match($pattern, ($form_state['values']['phone_number']), $matches);
  if (is_empty($matches)) {
    form_set_error('phone_number', t("The phone number entered is not valid"));
  }
}

function person_your_argument_is_invalid($form_state) {
  if ($form_state) {
    throw new Exception('Do you get here');
  }
}
